
Minimize s=1.0 -- lr=0.03

mu 0.1

Inner iteration 0
	h(W(model)): 3.004901454357145e-08
	score(model): 14.54955462768314
	 mle: 72.93423982463507
	 mse: 39.00241547679082
	W1: tensor([[0.0001, 0.0001, 0.0001],
        [0.0001, 0.0001, 0.0001],
        [0.0001, 0.0001, 0.0001]], grad_fn=<SqrtBackward0>)
	cycle loss: 3.000000063380969e-08
	structure loss: 4.9013909761755714e-11
	Sigma: tensor([[ 1.0000,  0.0304, -0.0107],
        [ 0.0304,  1.0000,  0.0375],
        [-0.0107,  0.0375,  1.0000]], grad_fn=<MmBackward0>)
Check M:  tensor([[-7.4898e-03,  0.0000e+00,  0.0000e+00],
        [-6.6628e-02,  9.1253e-02,  0.0000e+00],
        [-2.0000e+00, -2.0154e+00, -2.8526e+01]])
Check eigenvalues:  0.9460950363818611
Found h negative -2.116932357906767 at iter 1
success:  False

Minimize s=1 -- lr=0.015

mu 0.1

Inner iteration 0
	h(W(model)): 3.004901454357145e-08
	score(model): 14.54955462768314
	 mle: 103.65569125674376
	 mse: 53.7049053294863
	W1: tensor([[0.0001, 0.0001, 0.0001],
        [0.0001, 0.0001, 0.0001],
        [0.0001, 0.0001, 0.0001]], grad_fn=<SqrtBackward0>)
	cycle loss: 3.000000063380969e-08
	structure loss: 4.9013909761755714e-11
	Sigma: tensor([[ 1.0000,  0.0304, -0.0107],
        [ 0.0304,  1.0000,  0.0375],
        [-0.0107,  0.0375,  1.0000]], grad_fn=<MmBackward0>)
Check M:  tensor([[-7.4898e-03,  0.0000e+00,  0.0000e+00],
        [-6.6628e-02,  9.1253e-02,  0.0000e+00],
        [-2.0000e+00, -2.0154e+00, -2.8526e+01]])
Check eigenvalues:  0.9460950363818611
Found h negative -2.3429061931802644 at iter 4
success:  False

Minimize s=1 -- lr=0.0075

mu 0.1

Inner iteration 0
	h(W(model)): 3.004901454357145e-08
	score(model): 14.54955462768314
	 mle: 123.12018966314174
	 mse: 62.753532097961525
	W1: tensor([[0.0001, 0.0001, 0.0001],
        [0.0001, 0.0001, 0.0001],
        [0.0001, 0.0001, 0.0001]], grad_fn=<SqrtBackward0>)
	cycle loss: 3.000000063380969e-08
	structure loss: 4.9013909761755714e-11
	Sigma: tensor([[ 1.0000,  0.0304, -0.0107],
        [ 0.0304,  1.0000,  0.0375],
        [-0.0107,  0.0375,  1.0000]], grad_fn=<MmBackward0>)
Check M:  tensor([[-7.4898e-03,  0.0000e+00,  0.0000e+00],
        [-6.6628e-02,  9.1253e-02,  0.0000e+00],
        [-2.0000e+00, -2.0154e+00, -2.8526e+01]])
Check eigenvalues:  0.9460950363818611

mu 0.1

Inner iteration 1000
	h(W(model)): 0.16457067927928512
	score(model): -0.13830479576658952
	 mle: -3.037502096678028
	 mse: 0.7826119093864844
	W1: tensor([[1.0000e-04, 4.6908e-01, 7.6353e+00],
        [5.3038e-01, 1.0000e-04, 7.8594e+00],
        [2.3558e-02, 2.1475e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.14832064541752477
	structure loss: 0.016250033861760355
	Sigma: tensor([[ 1.8374e-01, -1.7413e-01, -1.0495e-03],
        [-1.7413e-01,  1.7311e-01, -8.3579e-04],
        [-1.0495e-03, -8.3579e-04,  1.9338e+00]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 0.0018,  0.0000,  0.0000],
        [ 0.0005,  0.0110,  0.0000],
        [-0.0098,  0.0481,  0.0890]])
Check eigenvalues:  0.004205863274760485

mu 0.1

Inner iteration 2000
	h(W(model)): 0.21645726132720755
	score(model): -0.28856139399476843
	 mle: -5.0553815288415755
	 mse: 0.7203343407851361
	W1: tensor([[1.0000e-04, 5.3934e-01, 7.7059e+00],
        [5.9254e-01, 1.0000e-04, 7.7908e+00],
        [2.0203e-02, 1.9636e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.18034213641097097
	structure loss: 0.036115124916236585
	Sigma: tensor([[ 0.1864, -0.1799, -0.0103],
        [-0.1799,  0.1756, -0.0102],
        [-0.0103, -0.0102,  0.8627]], grad_fn=<MmBackward0>)
Check M:  tensor([[0.0004, 0.0000, 0.0000],
        [0.0002, 0.0031, 0.0000],
        [0.0011, 0.0506, 0.1099]])
Check eigenvalues:  0.0007791883227622956

mu 0.1

Inner iteration 3000
	h(W(model)): 0.26617280428374995
	score(model): -0.4527953221779711
	 mle: -7.198839283440181
	 mse: 0.7282047714570173
	W1: tensor([[1.0000e-04, 5.7415e-01, 7.7004e+00],
        [6.0540e-01, 1.0000e-04, 7.7808e+00],
        [2.0800e-02, 2.0857e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.2118279501033875
	structure loss: 0.054344854180362445
	Sigma: tensor([[ 0.1857, -0.1820, -0.0148],
        [-0.1820,  0.1801, -0.0146],
        [-0.0148, -0.0146,  0.6013]], grad_fn=<MmBackward0>)
Check M:  tensor([[-0.0357,  0.0000,  0.0000],
        [-0.0849,  0.0035,  0.0000],
        [-0.0039,  0.0052,  0.1334]])
Check eigenvalues:  0.00011199660867417239

mu 0.1

Inner iteration 4000
	h(W(model)): 0.3127077564060056
	score(model): -0.6250357336951089
	 mle: -9.574029627992527
	 mse: 0.7340922576311089
	W1: tensor([[1.0000e-04, 5.8148e-01, 7.6678e+00],
        [6.0294e-01, 1.0000e-04, 7.7460e+00],
        [2.4816e-02, 2.5329e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.2533793950461911
	structure loss: 0.05932836135981451
	Sigma: tensor([[ 0.1849, -0.1823, -0.0159],
        [-0.1823,  0.1816, -0.0157],
        [-0.0159, -0.0157,  0.5472]], grad_fn=<MmBackward0>)
Check M:  tensor([[-1.1048,  0.0000,  0.0000],
        [-2.5929, -0.0298,  0.0000],
        [-0.1433, -0.0418,  0.0724]])
Check eigenvalues:  9.229847928232563e-06

mu 0.1

Inner iteration 4999
	h(W(model)): 0.34933872915457065
	score(model): -0.7579116608164678
	 mle: -11.07182104549167
	 mse: 0.7381035895882064
	W1: tensor([[1.0000e-04, 5.7067e-01, 7.6340e+00],
        [5.9733e-01, 1.0000e-04, 7.6944e+00],
        [2.8524e-02, 2.9785e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.28804357505368117
	structure loss: 0.06129515410088948
	Sigma: tensor([[ 0.1852, -0.1818, -0.0165],
        [-0.1818,  0.1806, -0.0163],
        [-0.0165, -0.0163,  0.5380]], grad_fn=<MmBackward0>)
Check M:  tensor([[-1.1732,  0.0000,  0.0000],
        [-2.7636,  0.0973,  0.0000],
        [-0.1675,  0.1320,  0.0350]])
Check eigenvalues:  1.3833309387036988e-06

Dagma iter t=2 -- mu: 0.05 ------------------------------
success:  False

Minimize s=1.0 -- lr=0.0075

mu 0.05

Inner iteration 0
	h(W(model)): 0.3491707808749105
	score(model): -0.20424670932718836
	 mle: 39952.96639139477
	 mse: 1.6306131139347548
	W1: tensor([[1.0000e-04, 5.7061e-01, 7.6352e+00],
        [5.9739e-01, 1.0000e-04, 7.6954e+00],
        [2.8511e-02, 2.9761e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.2878648328653268
	structure loss: 0.061305948009583666
	Sigma: tensor([[ 0.1852, -0.1819, -0.0165],
        [-0.1819,  0.1806, -0.0163],
        [-0.0165, -0.0163,  0.5380]], grad_fn=<MmBackward0>)
Check M:  tensor([[-4.5218e-01,  0.0000e+00,  0.0000e+00],
        [-1.1798e+00, -1.8030e-04,  0.0000e+00],
        [-7.3611e-02, -1.0154e-01,  1.7132e-02]])
Check eigenvalues:  1.3813842873156365e-06
Found h negative -0.5477956444318539 at iter 1
success:  False

Minimize s=1 -- lr=0.00375

mu 0.05

Inner iteration 0
	h(W(model)): 0.3491707808749105
	score(model): -0.20424670932718836
	 mle: 10111.721754507875
	 mse: 0.9647633668812812
	W1: tensor([[1.0000e-04, 5.7061e-01, 7.6352e+00],
        [5.9739e-01, 1.0000e-04, 7.6954e+00],
        [2.8511e-02, 2.9761e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.2878648328653268
	structure loss: 0.061305948009583666
	Sigma: tensor([[ 0.1852, -0.1819, -0.0165],
        [-0.1819,  0.1806, -0.0163],
        [-0.0165, -0.0163,  0.5380]], grad_fn=<MmBackward0>)
Check M:  tensor([[-4.5218e-01,  0.0000e+00,  0.0000e+00],
        [-1.1798e+00, -1.8030e-04,  0.0000e+00],
        [-7.3611e-02, -1.0154e-01,  1.7132e-02]])
Check eigenvalues:  1.3813842873156365e-06

mu 0.05

Inner iteration 1000
	h(W(model)): 0.4935191594595497
	score(model): 0.25108061726293723
	 mle: -4.860265766588697
	 mse: 0.8516468636281191
	W1: tensor([[1.0000e-04, 3.6328e-01, 7.2605e+00],
        [4.3971e-01, 1.0000e-04, 7.3668e+00],
        [4.7920e-02, 5.5073e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.4439850098867071
	structure loss: 0.049534149572842634
	Sigma: tensor([[ 0.1991, -0.1733, -0.0167],
        [-0.1733,  0.1548, -0.0182],
        [-0.0167, -0.0182,  0.2765]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 0.0294,  0.0000,  0.0000],
        [-0.0593,  0.7533,  0.0000],
        [ 0.0028,  1.8668, -0.1617]])
Check eigenvalues:  2.0057019819656266e-05

mu 0.05

Inner iteration 2000
	h(W(model)): 0.3449818932885912
	score(model): -0.08352257687446579
	 mle: -8.574719377828306
	 mse: 0.7535901705953025
	W1: tensor([[1.0000e-04, 4.1489e-01, 7.4255e+00],
        [4.8404e-01, 1.0000e-04, 7.5956e+00],
        [3.7922e-02, 4.0245e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.2853741429912642
	structure loss: 0.05960775029732701
	Sigma: tensor([[ 0.1880, -0.1762, -0.0190],
        [-0.1762,  0.1686, -0.0188],
        [-0.0190, -0.0188,  0.3971]], grad_fn=<MmBackward0>)
Check M:  tensor([[0.0651, 0.0000, 0.0000],
        [0.0626, 0.4144, 0.0000],
        [0.0013, 0.6414, 0.0106]])
Check eigenvalues:  1.14824036143664e-05

mu 0.05

Inner iteration 3000
	h(W(model)): 0.3137659802864633
	score(model): -0.15797867429273565
	 mle: -9.438738301285971
	 mse: 0.7455849773498198
	W1: tensor([[1.0000e-04, 4.7046e-01, 7.4857e+00],
        [5.1526e-01, 1.0000e-04, 7.6408e+00],
        [3.3563e-02, 3.4007e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.24995189999617473
	structure loss: 0.06381408029028857
	Sigma: tensor([[ 0.1819, -0.1752, -0.0193],
        [-0.1752,  0.1717, -0.0189],
        [-0.0193, -0.0189,  0.4690]], grad_fn=<MmBackward0>)
Check M:  tensor([[3.6428e-02, 0.0000e+00, 0.0000e+00],
        [5.7964e-03, 2.4674e-01, 0.0000e+00],
        [1.8969e-04, 2.5548e-01, 4.3571e-02]])
Check eigenvalues:  8.372060750626652e-06

mu 0.05

Inner iteration 4000
	h(W(model)): 0.30490892663947766
	score(model): -0.18296356566376704
	 mle: -9.761044874564988
	 mse: 0.7452238762054946
	W1: tensor([[1.0000e-04, 5.0594e-01, 7.5318e+00],
        [5.3623e-01, 1.0000e-04, 7.6514e+00],
        [3.1029e-02, 3.0826e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.240523551587966
	structure loss: 0.06438537505151165
	Sigma: tensor([[ 0.1769, -0.1726, -0.0190],
        [-0.1726,  0.1712, -0.0187],
        [-0.0190, -0.0187,  0.5089]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 0.0255,  0.0000,  0.0000],
        [-0.0082,  0.1538,  0.0000],
        [-0.0002,  0.0875,  0.0499]])
Check eigenvalues:  6.80015306330515e-06

mu 0.05

Inner iteration 4999
	h(W(model)): 0.3009306741915415
	score(model): -0.1935655440304137
	 mle: -9.893455336849431
	 mse: 0.7481655980902895
	W1: tensor([[1.0000e-04, 5.2770e-01, 7.5597e+00],
        [5.4909e-01, 1.0000e-04, 7.6577e+00],
        [2.9454e-02, 2.9129e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.23836003664979977
	structure loss: 0.06257063754174175
	Sigma: tensor([[ 0.1722, -0.1693, -0.0185],
        [-0.1693,  0.1690, -0.0182],
        [-0.0185, -0.0182,  0.5249]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 0.0186,  0.0000,  0.0000],
        [-0.0106,  0.1003,  0.0000],
        [-0.0003,  0.0137,  0.0499]])
Check eigenvalues:  5.886777957929057e-06

Dagma iter t=3 -- mu: 0.025 ------------------------------
success:  False

Minimize s=1.0 -- lr=0.00375

mu 0.025

Inner iteration 0
	h(W(model)): 0.3009271358825314
	score(model): 0.05367657525342756
	 mle: 948.7480409887854
	 mse: 0.9753712217345796
	W1: tensor([[1.0000e-04, 5.2772e-01, 7.5598e+00],
        [5.4910e-01, 1.0000e-04, 7.6577e+00],
        [2.9452e-02, 2.9128e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.2383594104015767
	structure loss: 0.06256772548095468
	Sigma: tensor([[ 0.1722, -0.1693, -0.0185],
        [-0.1693,  0.1690, -0.0182],
        [-0.0185, -0.0182,  0.5249]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 0.0496,  0.0000,  0.0000],
        [ 0.0049,  0.0946,  0.0000],
        [-0.0019, -0.0548,  0.0249]])
Check eigenvalues:  5.88597494750275e-06

mu 0.025

Inner iteration 1000
	h(W(model)): 0.250082022477708
	score(model): 0.05551636751875208
	 mle: -7.786376252245876
	 mse: 0.8040791325363301
	W1: tensor([[1.0000e-04, 4.9891e-01, 7.4932e+00],
        [5.0299e-01, 1.0000e-04, 7.5804e+00],
        [2.8924e-02, 2.7007e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.1913847424084354
	structure loss: 0.058697280069272606
	Sigma: tensor([[ 0.1590, -0.1584, -0.0190],
        [-0.1584,  0.1608, -0.0185],
        [-0.0190, -0.0185,  0.4915]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 0.0158,  0.0000,  0.0000],
        [-0.0327,  0.0966,  0.0000],
        [-0.0043, -0.0294,  0.0069]])
Check eigenvalues:  2.5630462709797727e-05

mu 0.025

Inner iteration 2000
	h(W(model)): 0.2309144321049527
	score(model): 0.03563149435506055
	 mle: -7.814640169434629
	 mse: 0.7830825240901402
	W1: tensor([[1.0000e-04, 5.2584e-01, 7.5614e+00],
        [5.2883e-01, 1.0000e-04, 7.6415e+00],
        [2.5891e-02, 2.5374e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.1916120227806264
	structure loss: 0.0393024093243263
	Sigma: tensor([[ 0.1424, -0.1417, -0.0146],
        [-0.1417,  0.1432, -0.0143],
        [-0.0146, -0.0143,  0.4174]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 0.0069,  0.0000,  0.0000],
        [-0.0064,  0.0234,  0.0000],
        [-0.0002, -0.0142,  0.0091]])
Check eigenvalues:  2.0161746642308173e-05

mu 0.025

Inner iteration 3000
	h(W(model)): 0.2257881642906328
	score(model): 0.03175137892861776
	 mle: -7.764928815417018
	 mse: 0.7723583236120197
	W1: tensor([[1.0000e-04, 5.3012e-01, 7.5766e+00],
        [5.3610e-01, 1.0000e-04, 7.6661e+00],
        [2.5237e-02, 2.5050e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.19246900054712057
	structure loss: 0.03331916374351224
	Sigma: tensor([[ 0.1363, -0.1353, -0.0131],
        [-0.1353,  0.1361, -0.0128],
        [-0.0131, -0.0128,  0.3826]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 4.5946e-04,  0.0000e+00,  0.0000e+00],
        [-5.2752e-04,  2.8965e-03,  0.0000e+00],
        [-1.5825e-05, -1.3671e-03,  7.4585e-03]])
Check eigenvalues:  1.7890586979994924e-05

mu 0.025

Inner iteration 4000
	h(W(model)): 0.22490921189791188
	score(model): 0.029331910968156627
	 mle: -7.826624787777448
	 mse: 0.7713562539068354
	W1: tensor([[1.0000e-04, 5.2842e-01, 7.5723e+00],
        [5.3761e-01, 1.0000e-04, 7.6729e+00],
        [2.5217e-02, 2.5019e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.19218528060957762
	structure loss: 0.03272393128833426
	Sigma: tensor([[ 0.1363, -0.1350, -0.0129],
        [-0.1350,  0.1355, -0.0127],
        [-0.0129, -0.0127,  0.3778]], grad_fn=<MmBackward0>)
Check M:  tensor([[-9.0472e-06,  0.0000e+00,  0.0000e+00],
        [ 5.9969e-05,  3.6883e-04,  0.0000e+00],
        [ 4.4658e-06,  9.5237e-05,  6.0997e-03]])
Check eigenvalues:  1.6049023847793798e-05

mu 0.025

Inner iteration 4999
	h(W(model)): 0.22539679614902847
	score(model): 0.026683495103304727
	 mle: -7.952137937608631
	 mse: 0.7727460648024476
	W1: tensor([[1.0000e-04, 5.2675e-01, 7.5622e+00],
        [5.3836e-01, 1.0000e-04, 7.6737e+00],
        [2.5327e-02, 2.5111e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.1925722131331149
	structure loss: 0.032824583015913567
	Sigma: tensor([[ 0.1368, -0.1353, -0.0130],
        [-0.1353,  0.1355, -0.0127],
        [-0.0130, -0.0127,  0.3775]], grad_fn=<MmBackward0>)
Check M:  tensor([[5.8180e-05, 0.0000e+00, 0.0000e+00],
        [4.3976e-05, 3.8006e-04, 0.0000e+00],
        [4.9030e-06, 1.4296e-04, 5.5151e-03]])
Check eigenvalues:  1.3879899658785202e-05

Dagma iter t=4 -- mu: 0.0125 ------------------------------
success:  False

Minimize s=1.0 -- lr=0.00375

mu 0.0125

Inner iteration 0
	h(W(model)): 0.2253980472976348
	score(model): 0.12603931163704085
	 mle: 420.72829488305797
	 mse: 0.9899945886355211
	W1: tensor([[1.0000e-04, 5.2675e-01, 7.5622e+00],
        [5.3836e-01, 1.0000e-04, 7.6737e+00],
        [2.5327e-02, 2.5112e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.19257332973905772
	structure loss: 0.03282471755857708
	Sigma: tensor([[ 0.1368, -0.1353, -0.0130],
        [-0.1353,  0.1355, -0.0127],
        [-0.0130, -0.0127,  0.3775]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 0.0221,  0.0000,  0.0000],
        [-0.0004,  0.0219,  0.0000],
        [-0.0018, -0.0356,  0.0028]])
Check eigenvalues:  1.3877414183400489e-05
Found h negative -0.7871876696397377 at iter 11
success:  False

Minimize s=1 -- lr=0.001875

mu 0.0125

Inner iteration 0
	h(W(model)): 0.2253980472976348
	score(model): 0.12603931163704085
	 mle: 102.29213784652195
	 mse: 0.8466107126593971
	W1: tensor([[1.0000e-04, 5.2675e-01, 7.5622e+00],
        [5.3836e-01, 1.0000e-04, 7.6737e+00],
        [2.5327e-02, 2.5112e-02, 1.0000e-04]], grad_fn=<SqrtBackward0>)
	cycle loss: 0.19257332973905772
	structure loss: 0.03282471755857708
	Sigma: tensor([[ 0.1368, -0.1353, -0.0130],
        [-0.1353,  0.1355, -0.0127],
        [-0.0130, -0.0127,  0.3775]], grad_fn=<MmBackward0>)
Check M:  tensor([[ 0.0221,  0.0000,  0.0000],
        [-0.0004,  0.0219,  0.0000],
        [-0.0018, -0.0356,  0.0028]])
Check eigenvalues:  1.3877414183400489e-05
Traceback (most recent call last):
  File "/Users/yurou_liang/Desktop/ADMG_RKHS/ADMG/admg_rkhs_discovery.py", line 734, in <module>
    W1, W2, output = model2.fit(data, lambda1=1e-3, tau=1e-4, T = 6, mu_init = 0.1, lr=0.03, w_threshold=0.0)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yurou_liang/Desktop/ADMG_RKHS/ADMG/admg_rkhs_discovery.py", line 563, in fit
    success = self.minimize(inner_iter, lr, lambda1, tau, lambda2, mu, s_cur,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yurou_liang/Desktop/ADMG_RKHS/ADMG/admg_rkhs_discovery.py", line 387, in minimize
    W1, W2 = self.model.fc1_to_adj()
             ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/yurou_liang/Desktop/ADMG_RKHS/ADMG/admg_rkhs_discovery.py", line 241, in fc1_to_adj
    weight2 = torch.einsum('jal, jilka -> kij', self.beta, self.mixed_grad) # [d, n, d]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/admg/lib/python3.11/site-packages/torch/functional.py", line 374, in einsum
    return handle_torch_function(einsum, operands, equation, *operands)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/admg/lib/python3.11/site-packages/torch/overrides.py", line 1630, in handle_torch_function
    result = mode.__torch_function__(public_api, types, args, kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/admg/lib/python3.11/site-packages/torch/utils/_device.py", line 79, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/admg/lib/python3.11/site-packages/torch/functional.py", line 386, in einsum
    return _VF.einsum(equation, operands)  # type: ignore[attr-defined]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
